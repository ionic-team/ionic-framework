@use "../../themes/mixins" as mixins;
@use "../../themes/functions.color" as colors;
@use "./chip.base.vars.scss" as vars;
@use "sass:meta";

// Chip: Common Styles
// --------------------------------------------------

:host {
  /**
   * @prop --background: Background of the chip
   * @prop --border-radius: Border radius of the chip
   * @prop --color: Color of the chip
   * @prop --focus-ring-color: Color of the focus ring
   * @prop --focus-ring-width: Width of the focus ring
   */
  --focus-ring-color: #{vars.$chip-focus-ring-color};
  --focus-ring-width: #{vars.$chip-focus-ring-width};

  @include mixins.font-smoothing();
  @include mixins.border-radius(var(--border-radius));
  @include mixins.margin(vars.$chip-margin);
  @include mixins.padding(vars.$chip-padding-vertical, vars.$chip-padding-horizontal);
  @include mixins.typography(vars.$chip-typography);

  display: inline-flex;
  position: relative;

  align-items: center;
  justify-content: center;

  background: var(--background);
  color: var(--color);

  line-height: vars.$chip-line-height;

  cursor: pointer;
  overflow: hidden;
  vertical-align: middle;
  box-sizing: border-box;

  gap: vars.$chip-gap;
}

// Chip Sizes
// ---------------------------------------------

:host(.chip-small) {
  min-height: vars.$chip-size-small-height;

  font-size: vars.$chip-size-small-font-size;
}

:host(.chip-large) {
  min-height: vars.$chip-size-large-height;

  font-size: vars.$chip-size-large-font-size;
}

// Chip Shapes
// ---------------------------------------------

:host(.chip-soft) {
  --border-radius: #{vars.$chip-border-radius-soft};
}

:host(.chip-round) {
  --border-radius: #{vars.$chip-border-radius-round};
}

:host(.chip-rectangular) {
  --border-radius: #{vars.$chip-border-radius-rectangular};
}

// Chip Hues
// ---------------------------------------------

// Bold
:host(.chip-bold) {
  --background: #{vars.$chip-hue-bold-bg};
  --color: #{vars.$chip-hue-bold-color};
}

:host(.chip-bold.chip-outline) {
  border-color: #{vars.$chip-hue-bold-outline-border-color};
  // background: #{vars.$chip-hue-bold-outline-bg};
}

// Subtle
:host(.chip-subtle) {
  --background: #{vars.$chip-hue-subtle-bg};
  --color: #{vars.$chip-hue-subtle-color};
}

:host(.chip-subtle.chip-outline) {
  border-color: #{vars.$chip-hue-subtle-outline-border-color};
  // background: #{vars.$chip-hue-subtle-outline-bg};
}

// Chip Colors
// ---------------------------------------------

// Bold
:host(.ion-color.chip-bold) {
  background: var(--ion-chip-hue-bold-semantic-bg);
  color: vars.$chip-hue-bold-semantic-color;
}

:host(.ion-color.chip-bold.chip-outline) {
  border-color: vars.$chip-hue-bold-semantic-outline-border-color;

  // background: vars.$chip-outline-bold-semantic-bg; //native would be transparent, else it would be whatevers in ion-color.chip-bold
}

// Subtle
:host(.ion-color.chip-subtle) {
  background: colors.current-color(base, $subtle: true); // always the same regardless of theme
  color: colors.current-color(contrast, $subtle: true); // always the same regardless of theme
}

:host(.ion-color.chip-subtle.chip-outline) {
  border-color: colors.current-color(shade, $subtle: true);

  // background: vars.$chip-outline-subtle-semantic-bg;
}

// Outline Chip
// ---------------------------------------------

:host(.chip-outline) {
  border-width: vars.$chip-outline-border-width;
  border-style: solid;

  background: var(--ion-chip-variant-outline-bg, var(--background));
}

:host(.chip-outline.ion-color.chip-bold) {
  background: vars.$chip-outline-bold-semantic-bg;
}

:host(.chip-outline.ion-color.chip-subtle) {
  background: var(--ion-chip-variant-outline-bg, colors.current-color(base, $subtle: true));
}

// Chip States
// ---------------------------------------------

// Disabled
:host(.chip-disabled) {
  cursor: default;
  opacity: vars.$chip-state-disabled-opacity;
  pointer-events: none;
}

// Focus
:host(.ion-focused) {
  @include mixins.focused-state(var(--focus-ring-width), $color: var(--focus-ring-color));
}

:host(.ion-focused.chip-bold) {
  --background: var(--ion-chip-state-focus-bg, var(--ion-chip-hue-bold-bg));
}

:host(.ion-focused.chip-subtle) {
  --background: var(--ion-chip-state-focus-bg, var(--ion-chip-hue-subtle-bg));
}

:host(.ion-focused.ion-color.chip-bold) {
  background: var(--ion-chip-hue-bold-semantic-state-focus-bg, vars.$chip-hue-bold-semantic-bg);
}

:host(.ion-focused.ion-color.chip-subtle) {
  background: var(--ion-chip-hue-subtle-semantic-state-focus-bg, vars.$chip-hue-subtle-semantic-bg);
}

:host(.ion-focused.chip-outline.chip-bold:not(.ion-color)) {
  background: var(--ion-chip-variant-outline-state-focus-bg-bold, var(--ion-chip-hue-bold-bg));
}

:host(.ion-focused.chip-outline.chip-subtle:not(.ion-color)) {
  background: var(--ion-chip-variant-outline-state-focus-bg-subtle, var(--ion-chip-hue-subtle-bg));
}

// Activated
:host(.ion-activated) {
  --background: #{vars.$chip-activated-bg};
}

:host(.ion-activated.ion-color) {
  background: vars.$chip-activated-semantic-bg;
}

// Hover
@media (any-hover: hover) {
  :host(.chip-bold:hover) {
    --background: var(--ion-chip-state-hover-bg, var(--ion-chip-hue-bold-bg));
  }

  :host(.chip-subtle:hover) {
    --background: var(--ion-chip-state-hover-bg, var(--ion-chip-hue-subtle-bg));
  }

  :host(.chip-bold.ion-color:hover) {
    background: var(--ion-chip-hue-bold-semantic-state-hover-bg, var(--ion-chip-hue-bold-semantic-bg));
  }

  :host(.chip-subtle.ion-color:hover) {
    background: var(--ion-chip-hue-subtle-semantic-state-hover-bg, var(--ion-chip-hue-subtle-semantic-bg));
  }

  :host(.chip-outline.chip-bold:not(.ion-color):hover) {
    background: var(--ion-chip-variant-outline-state-hover-bg-bold, var(--background));
  }

  :host(.chip-outline.chip-subtle:not(.ion-color):hover) {
    background: var(--ion-chip-variant-outline-state-hover-bg-subtle, var(--background));
  }
}

// Chip Slotted Elements
// ---------------------------------------------

// Icon
::slotted(ion-icon) {
  font-size: vars.$chip-icon-size;
}

:host(:not(.ion-color)) ::slotted(ion-icon) {
  color: vars.$chip-icon-color;
}

::slotted(ion-icon:first-child) {
  @include mixins.margin(
    vars.$chip-icon-first-child-margin,
    vars.$chip-icon-first-child-margin-end,
    $start: vars.$chip-icon-first-child-margin
  );
}

::slotted(ion-icon:last-child) {
  @include mixins.margin(vars.$chip-icon-last-child-margin, $start: vars.$chip-icon-last-child-margin-start);
}

// Avatar
::slotted(ion-avatar) {
  // width: vars.$chip-avatar-size;
  // height: vars.$chip-avatar-size;
  // @error vars.$chip-avatar-size;
  @if vars.$chip-avatar-size != "unset" {
    width: vars.$chip-avatar-size;
    height: vars.$chip-avatar-size;
  }
  flex-shrink: 0;
}

::slotted(ion-avatar:first-child) {
  @include mixins.margin(
    vars.$chip-avatar-first-child-margin-vertical,
    $end: vars.$chip-avatar-first-child-margin-end,
    $start: vars.$chip-avatar-first-child-margin-start
  );
}

::slotted(ion-avatar:last-child) {
  @include mixins.margin(
    vars.$chip-avatar-last-child-margin-vertical,
    $end: vars.$chip-avatar-last-child-margin-end,
    $start: vars.$chip-avatar-last-child-margin-start
  );
}
