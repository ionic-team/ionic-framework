@use "../../themes/ionic/ionic.globals.scss" as globals;
@use "searchbar.common";
@use "./searchbar.ionic.vars" as searchbarVars;

// Ionic Searchbar
// --------------------------------------------------

:host {
  /**
   * @prop --focus-ring-color: The color of the ring around the focused element.
   * @prop --focus-ring-width: The width of the ring around the focused element.
   */
  --background: #{globals.$ionic-color-neutral-100};
  --border-radius: #{globals.$ionic-border-radius-400};
  --box-shadow: none;
  --cancel-button-color: #{globals.$ionic-color-neutral-800};
  --clear-button-color: #{globals.$ionic-color-neutral-1000};
  --color: #{globals.$ionic-color-neutral-1200};
  --icon-color: #{globals.$ionic-color-neutral-800};
  --placeholder-color: #{globals.$ionic-color-neutral-800};
  --focus-ring-color: #{globals.$ionic-state-focus-1};
  --focus-ring-width: #{globals.$ionic-border-size-050};

  @include globals.typography(globals.$ionic-body-md-regular);
  @include globals.padding(0);
}

// Searchbar Search Icon
// -----------------------------------------

.searchbar-search-icon {
  @include globals.position(
    searchbarVars.$searchbar-ionic-input-search-icon-size,
    null,
    null,
    searchbarVars.$searchbar-ionic-input-search-icon-size
  );

  width: searchbarVars.$searchbar-ionic-input-search-icon-size;
  height: searchbarVars.$searchbar-ionic-input-search-icon-size;
}

// Searchbar Input Field
// -----------------------------------------

.searchbar-input {
  @include globals.padding(
    globals.$ionic-space-300,
    searchbarVars.$searchbar-ionic-padding-end,
    globals.$ionic-space-300,
    searchbarVars.$searchbar-ionic-padding-start
  );

  min-height: globals.$ionic-scale-1200;

  contain: strict;
}

// Searchbar Clear Input Icon
// -----------------------------------------

.searchbar-clear-button {
  @include globals.position(
    searchbarVars.$searchbar-ionic-input-clear-icon-size,
    searchbarVars.$searchbar-ionic-input-clear-icon-size,
    null,
    null
  );

  width: searchbarVars.$searchbar-ionic-input-clear-icon-size;
  height: searchbarVars.$searchbar-ionic-input-clear-icon-size;

  background-color: transparent;

  font-size: globals.$ionic-font-size-400;

  contain: strict;
}

// Searchbar Cancel Icon
// -----------------------------------------

.searchbar-cancel-button {
  /**
   * The left edge of the cancel button
   * should align with the left edge
   * of the back button if the searchbar
   * is used in a toolbar.
   */
  @include globals.position(0, null, null, 9px);

  background-color: transparent;

  font-size: globals.$ionic-font-size-400;
}

// Searchbar Search & Clear Icon & Cancel Icon
// -----------------------------------------

.searchbar-search-icon,
.searchbar-clear-button,
.searchbar-cancel-button {
  position: absolute;
}

// Clear Icon & Cancel Icon
// -----------------------------------------

.searchbar-clear-button:focus-visible,
.searchbar-cancel-button:focus-visible ion-icon {
  @include globals.border-radius(globals.$ionic-border-radius-100);

  outline: globals.$ionic-border-size-050 globals.$ionic-border-style-solid globals.$ionic-state-focus-1;

  opacity: 1;
}

// Searchbar in Toolbar
// -----------------------------------------

:host-context(ion-toolbar) {
  min-height: globals.$ionic-scale-1200;
}

// Searchbar States
// --------------------------------------------------

/* Hover */
:host(:hover) {
  --icon-color: #{globals.$ionic-color-neutral-900};
}

/* Focus */
:host(.searchbar-has-focus) .searchbar-input {
  outline: var(--focus-ring-width) globals.$ionic-border-style-solid var(--focus-ring-color);
}

:host(.searchbar-has-focus) .searchbar-search-icon,
:host(.searchbar-has-focus) .searchbar-cancel-button,
:host(.searchbar-should-show-cancel) .searchbar-cancel-button {
  display: block;
}

:host(.searchbar-has-focus) .searchbar-cancel-button + .searchbar-search-icon,
:host(.searchbar-should-show-cancel) .searchbar-cancel-button + .searchbar-search-icon {
  display: none;
}

/* Disabled */
:host(.searchbar-disabled) {
  --color: #{globals.$ionic-color-neutral-500};
  --icon-color: #{globals.$ionic-color-neutral-500};
  --placeholder-color: #{globals.$ionic-color-neutral-500};

  cursor: default;
  pointer-events: none;
}
