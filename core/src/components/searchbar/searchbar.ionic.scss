@use "../../themes/ionic/ionic.globals.scss" as globals;
@use "searchbar.common";

// Ionic Searchbar
// --------------------------------------------------

:host {
  /**
   * @prop --focus-ring-color: The color of the ring around the focused element.
   * @prop --focus-ring-width: The width of the ring around the focused element.
   */
  --background: #{globals.$ion-bg-neutral-subtle-default};
  --border-radius: #{globals.$ion-border-radius-400};
  --box-shadow: none;
  --cancel-button-color: #{globals.$ion-primitives-neutral-800};
  --clear-button-color: #{globals.$ion-primitives-neutral-1000};
  --color: #{globals.$ion-primitives-neutral-1200};
  --icon-color: #{globals.$ion-icon-default};
  --placeholder-color: #{globals.$ion-text-subtlest};
  --focus-ring-color: #{globals.$ion-border-focus-default};
  --focus-ring-width: #{globals.$ion-border-size-050};
  --leading-icon-padding: #{calc(globals.$ion-scale-400 + globals.$ion-space-200)};
  --clear-button-padding: #{calc(globals.$ion-scale-400 + globals.$ion-space-200)};

  @include globals.typography(globals.$ion-body-md-regular);
  @include globals.padding(0);
}

// Searchbar Search Icon
// -----------------------------------------

.searchbar-search-icon {
  width: globals.$ion-scale-400;
  height: globals.$ion-scale-400;
}

// Searchbar Input Field
// -----------------------------------------

.searchbar-input {
  @include globals.padding(globals.$ion-space-300, null);

  text-overflow: ellipsis;

  contain: strict;
}

// Searchbar Clear Input Icon
// -----------------------------------------

.searchbar-clear-button {
  width: globals.$ion-scale-400;
  height: globals.$ion-scale-400;

  background-color: transparent;

  font-size: globals.$ion-scale-400;

  contain: strict;
}

:host(:not(.searchbar-should-show-clear)) {
  --clear-button-padding: #{globals.$ion-scale-0};
}

// Searchbar Cancel Icon
// -----------------------------------------

.searchbar-cancel-button {
  width: globals.$ion-scale-400;
  height: globals.$ion-scale-400;

  background-color: transparent;

  font-size: globals.$ion-font-size-400;
}

// Searchbar Search Icon & Clear Icon & Cancel Icon
// -----------------------------------------

.searchbar-search-icon,
.searchbar-clear-button,
.searchbar-cancel-button {
  @include globals.position(50%, null);

  position: absolute;

  transform: translateY(-50%);
}

// Searchbar Clear Icon & Cancel Icon
// -----------------------------------------

.searchbar-clear-button:focus-visible,
.searchbar-cancel-button:focus-visible ion-icon {
  @include globals.border-radius(globals.$ion-border-radius-100);

  outline: globals.$ion-border-size-050 globals.$ion-border-style-solid globals.$ion-border-focus-default;

  opacity: 1;
}

// Searchbar Search Icon & Cancel Icon
// -----------------------------------------
:host(:not(.searchbar-has-leading-icons)) {
  --leading-icon-padding: #{globals.$ion-scale-0};
}

:host(:not(.searchbar-has-value)) {
  --icon-color: #{globals.$ion-icon-subtlest};
}

// Searchbar in Toolbar
// -----------------------------------------

:host-context(ion-toolbar).searchbar-should-show-cancel .searchbar-cancel-button {
  /**
   * The left edge of the cancel button
   * should align with the left edge
   * of the back button if the searchbar
   * is used in a toolbar regardless of
   * the searchbar size.
   */
  @include globals.position-horizontal(9px, null);
}

:host-context(ion-toolbar).searchbar-should-show-cancel .searchbar-input {
  /**
   * Padding start is based on
   * the alignment of the back button,
   * the size of the leading icon (search or cancel),
   * and the gap between the icon and the input.
   */
  padding-inline-start: calc(9px + var(--leading-icon-padding));
}

// Searchbar States
// --------------------------------------------------

/* Hover */
:host(:hover) {
  --background: #{globals.$ion-primitives-neutral-200};
}

/* Focus */
:host(.searchbar-has-focus) .searchbar-input {
  outline: var(--focus-ring-width) globals.$ion-border-style-solid var(--focus-ring-color);
}

:host(.searchbar-has-focus) .searchbar-search-icon,
:host(.searchbar-has-focus) .searchbar-cancel-button,
:host(.searchbar-should-show-cancel) .searchbar-cancel-button {
  display: block;
}

:host(.searchbar-has-focus) .searchbar-cancel-button + .searchbar-search-icon,
:host(.searchbar-should-show-cancel) .searchbar-cancel-button + .searchbar-search-icon {
  display: none;
}

/* Disabled */
:host(.searchbar-disabled) {
  --color: #{globals.$ion-primitives-neutral-500};
  --icon-color: #{globals.$ion-icon-disabled};
  --placeholder-color: #{globals.$ion-text-disabled};

  cursor: default;
  pointer-events: none;
}

// Searchbar Shapes
// --------------------------------------------------

:host(.searchbar-shape-soft) {
  --border-radius: #{globals.$ion-border-radius-200};
}

:host(.searchbar-shape-round) {
  --border-radius: #{globals.$ion-border-radius-400};
}

:host(.searchbar-shape-rectangular) {
  --border-radius: #{globals.$ion-border-radius-0};
}

// Searchbar Sizes
// --------------------------------------------------

/* Small */
:host(.searchbar-size-small) .searchbar-input {
  /**
   * Padding start is based on
   * desired padding from design,
   * the size of the leading icon (search or cancel),
   * and the gap between the icon and the input.
   *
   * Padding end is based on
   * desired padding from design,
   * the size of the trailing icon (clear),
   * and the gap between the icon and the input.
   */
  @include globals.padding-horizontal(
    calc(globals.$ion-space-300 + var(--leading-icon-padding)),
    calc(globals.$ion-space-300 + var(--clear-button-padding))
  );

  height: globals.$ion-scale-1000;
}

:host(.searchbar-size-small) .searchbar-search-icon,
:host(.searchbar-size-small) .searchbar-cancel-button {
  // Start is based on the desired padding start from design.
  @include globals.position-horizontal(globals.$ion-space-300, null);
}

:host(.searchbar-size-small) .searchbar-clear-button {
  // End is based on the desired padding end from design.
  @include globals.position-horizontal(null, globals.$ion-space-300);
}

/* Medium */
:host(.searchbar-size-medium) .searchbar-input {
  /**
   * Padding start is based on
   * desired padding from design,
   * the size of the leading icon (search or cancel),
   * and the gap between the icon and the input.
   *
   * Padding end is based on
   * desired padding from design,
   * the size of the trailing icon (clear),
   * and the gap between the icon and the input.
   */
  @include globals.padding-horizontal(
    calc(globals.$ion-space-400 + var(--leading-icon-padding)),
    calc(globals.$ion-space-400 + var(--clear-button-padding))
  );

  height: globals.$ion-scale-1200;
}

:host(.searchbar-size-medium) .searchbar-search-icon,
:host(.searchbar-size-medium) .searchbar-cancel-button {
  // Start is based on the desired padding start from design.
  @include globals.position-horizontal(globals.$ion-space-400, null);
}

:host(.searchbar-size-medium) .searchbar-clear-button {
  // End is based on the desired padding end from design.
  @include globals.position-horizontal(null, globals.$ion-space-400);
}

/* Large */
:host(.searchbar-size-large) .searchbar-search-icon,
:host(.searchbar-size-large) .searchbar-cancel-button {
  --leading-icon-padding: #{calc(globals.$ion-scale-500 + globals.$ion-space-200)};

  width: globals.$ion-scale-500;
  height: globals.$ion-scale-500;
}

:host(.searchbar-size-large) .searchbar-cancel-button {
  font-size: globals.$ion-font-size-500;
}

:host-context(ion-toolbar).searchbar-size-large.searchbar-should-show-cancel .searchbar-input {
  /**
   * Padding start is based on
   * the alignment of the back button,
   * the size of the leading icon (search or cancel),
   * and the gap between the icon and the input.
   */
  padding-inline-start: calc(9px + var(--leading-icon-padding));
}

:host(.searchbar-size-large) .searchbar-input {
  @include globals.padding(globals.$ion-space-400, null);

  /**
   * Padding start is based on
   * desired padding from design,
   * the size of the leading icon (search or cancel),
   * and the gap between the icon and the input.
   *
   * Padding end is based on
   * desired padding from design,
   * the size of the trailing icon (clear),
   * and the gap between the icon and the input.
   */
  @include globals.padding-horizontal(
    calc(globals.$ion-space-500 + var(--leading-icon-padding)),
    calc(globals.$ion-space-500 + var(--clear-button-padding))
  );

  height: globals.$ion-scale-1400;
}

:host(.searchbar-size-large) .searchbar-search-icon,
:host(.searchbar-size-large) .searchbar-cancel-button {
  // Start is based on the desired padding start from design.
  @include globals.position-horizontal(globals.$ion-space-500, null);
}

:host(.searchbar-size-large) .searchbar-clear-button {
  // End is based on the desired padding end from design.
  @include globals.position-horizontal(null, globals.$ion-space-500);
}
